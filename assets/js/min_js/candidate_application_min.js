document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("candidate-year"),t=document.getElementById("candidate-month"),n=document.getElementById("candidate-day"),a=document.getElementById("candidate-application-form"),r=document.getElementById("candidate-submit"),d=new Date().getFullYear(),l;for(let o=d-60;o<=d-18;o++){let s=document.createElement("option");s.value=o,s.textContent=o,e.appendChild(s)}let i=["January","February","March","April","May","June","July","August","September","October","November","December"];function c(){n.innerHTML="<option value=''>Day</option>";let a=parseInt(e.value),r=parseInt(t.value);if(!a||!r)return;let d=new Date(a,r,0).getDate();for(let l=1;l<=d;l++){let o=document.createElement("option");o.value=l,o.textContent=l,n.appendChild(o)}}function u(e,t="error",n=null){let r=document.getElementById("candidate-form-message");r||((r=document.createElement("div")).id="candidate-form-message",r.style.marginTop="10px",r.style.padding="10px",r.style.borderRadius="5px",r.style.fontWeight="500",a.append(r)),r.textContent=e,r.style.backgroundColor="success"===t?"#d4edda":"#f8d7da",r.style.color="success"===t?"#155724":"#721c24",r.style.border="success"===t?"1px solid #c3e6cb":"1px solid #f5c6cb",a.querySelectorAll("input,select,textarea").forEach(e=>e.style.borderColor=""),n&&(n.style.borderColor="#e3342f"),l&&clearTimeout(l),l=setTimeout(()=>{r.remove(),a.querySelectorAll("input,select,textarea").forEach(e=>e.style.borderColor="")},5e3)}i.forEach((e,n)=>{let a=document.createElement("option");a.value=n+1,a.textContent=e,t.appendChild(a)}),e.addEventListener("change",c),t.addEventListener("change",c),a.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("candidate-phone").value.trim(),d=/^\+?\s*(?:\d\s*){10,15}$/;if(!t.match(d)){u("Invalid phone number. Enter 10â€“15 digits, spaces and + allowed.","error",document.getElementById("candidate-phone"));return}let l=new FormData(a);r.disabled=!0,r.textContent="Submitting...",fetch("candidate_submit.php",{method:"POST",body:l}).then(e=>e.json()).then(e=>{"success"===e.status?(u(e.message,"success"),a.reset(),n.innerHTML="<option value=''>Day</option>"):u(e.message,"error"),r.disabled=!1,r.textContent="Submit"}).catch(e=>{u("Server error. Check console.","error"),console.error(e),r.disabled=!1,r.textContent="Submit"})})});